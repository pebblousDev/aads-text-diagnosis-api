#!/bin/bash
sudo -u pbls_dev bash -c 'if [ -f /home/pbls_dev/.ssh/id_ed25519 ]; then echo "âœ… SSH key already exists"; else echo "ðŸ”§ Creating new SSH key..." && mkdir -p /home/pbls_dev/.ssh && ssh-keygen -t ed25519 -f /home/pbls_dev/.ssh/id_ed25519 -N ""; fi && echo "ðŸ”§ Adding key to authorized_keys..." && mkdir -p /home/pbls_dev/.ssh && cat /home/pbls_dev/.ssh/id_ed25519.pub > /home/pbls_dev/.ssh/authorized_keys && chmod 700 /home/pbls_dev/.ssh && chmod 600 /home/pbls_dev/.ssh/authorized_keys && echo "ðŸ§ª Testing SSH..." && ssh -i /home/pbls_dev/.ssh/id_ed25519 -o StrictHostKeyChecking=no pbls_dev@localhost "echo \"SSH successful!\""'
